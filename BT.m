function [BT]=BT(r1,r2,r3,r4,x_loc,y_loc,z1,z2,z3,z4)
BT=[(r1.*(1.0./2.0)-r2.*(1.0./2.0)-r3.*(1.0./2.0)+r4.*(1.0./2.0)-z1.*(1.0./2.0)+z2.*(1.0./2.0)+z3.*(1.0./2.0)-z4.*(1.0./2.0)-r1.*x_loc+r2.*x_loc+x_loc.*z1.*(1.0./2.0)-x_loc.*z2.*(1.0./2.0)+x_loc.*z3.*(1.0./2.0)-x_loc.*z4.*(1.0./2.0)+y_loc.*z1.*(1.0./2.0)-y_loc.*z2.*(1.0./2.0)-y_loc.*z3.*(1.0./2.0)+y_loc.*z4.*(1.0./2.0)+r1.*x_loc.^2.*(1.0./2.0)-r2.*x_loc.^2.*(1.0./2.0)+r3.*x_loc.^2.*(1.0./2.0)-r4.*x_loc.^2.*(1.0./2.0)-x_loc.*y_loc.*z1.*(1.0./2.0)+x_loc.*y_loc.*z2.*(1.0./2.0)-x_loc.*y_loc.*z3.*(1.0./2.0)+x_loc.*y_loc.*z4.*(1.0./2.0))./(r1.*z2-r2.*z1-r1.*z4+r2.*z3-r3.*z2+r4.*z1+r3.*z4-r4.*z3-r1.*x_loc.*z2+r2.*x_loc.*z1+r1.*x_loc.*z3-r3.*x_loc.*z1-r2.*x_loc.*z4+r4.*x_loc.*z2+r3.*x_loc.*z4-r4.*x_loc.*z3-r1.*y_loc.*z3+r3.*y_loc.*z1+r1.*y_loc.*z4+r2.*y_loc.*z3-r3.*y_loc.*z2-r4.*y_loc.*z1-r2.*y_loc.*z4+r4.*y_loc.*z2),zeros(length(r1),1),((x_loc-1.0).*(y_loc-1.0))./(r1.*(x_loc-1.0).*(y_loc-1.0)-r2.*(x_loc-1.0).*(y_loc+1.0)+r3.*(x_loc+1.0).*(y_loc+1.0)-r4.*(x_loc+1.0).*(y_loc-1.0)),-(r2-r4-r2.*x_loc+r3.*x_loc-r3.*y_loc+r4.*y_loc)./(r1.*z2-r2.*z1-r1.*z4+r2.*z3-r3.*z2+r4.*z1+r3.*z4-r4.*z3-r1.*x_loc.*z2+r2.*x_loc.*z1+r1.*x_loc.*z3-r3.*x_loc.*z1-r2.*x_loc.*z4+r4.*x_loc.*z2+r3.*x_loc.*z4-r4.*x_loc.*z3-r1.*y_loc.*z3+r3.*y_loc.*z1+r1.*y_loc.*z4+r2.*y_loc.*z3-r3.*y_loc.*z2-r4.*y_loc.*z1-r2.*y_loc.*z4+r4.*y_loc.*z2),zeros(length(r1),1),-(r2-r4-r2.*x_loc+r3.*x_loc-r3.*y_loc+r4.*y_loc)./(r1.*z2-r2.*z1-r1.*z4+r2.*z3-r3.*z2+r4.*z1+r3.*z4-r4.*z3-r1.*x_loc.*z2+r2.*x_loc.*z1+r1.*x_loc.*z3-r3.*x_loc.*z1-r2.*x_loc.*z4+r4.*x_loc.*z2+r3.*x_loc.*z4-r4.*x_loc.*z3-r1.*y_loc.*z3+r3.*y_loc.*z1+r1.*y_loc.*z4+r2.*y_loc.*z3-r3.*y_loc.*z2-r4.*y_loc.*z1-r2.*y_loc.*z4+r4.*y_loc.*z2),zeros(length(r1),1),(r1.*(1.0./2.0)-r2.*(1.0./2.0)-r3.*(1.0./2.0)+r4.*(1.0./2.0)-z1.*(1.0./2.0)+z2.*(1.0./2.0)+z3.*(1.0./2.0)-z4.*(1.0./2.0)-r1.*x_loc+r2.*x_loc+x_loc.*z1.*(1.0./2.0)-x_loc.*z2.*(1.0./2.0)+x_loc.*z3.*(1.0./2.0)-x_loc.*z4.*(1.0./2.0)+y_loc.*z1.*(1.0./2.0)-y_loc.*z2.*(1.0./2.0)-y_loc.*z3.*(1.0./2.0)+y_loc.*z4.*(1.0./2.0)+r1.*x_loc.^2.*(1.0./2.0)-r2.*x_loc.^2.*(1.0./2.0)+r3.*x_loc.^2.*(1.0./2.0)-r4.*x_loc.^2.*(1.0./2.0)-x_loc.*y_loc.*z1.*(1.0./2.0)+x_loc.*y_loc.*z2.*(1.0./2.0)-x_loc.*y_loc.*z3.*(1.0./2.0)+x_loc.*y_loc.*z4.*(1.0./2.0))./(r1.*z2-r2.*z1-r1.*z4+r2.*z3-r3.*z2+r4.*z1+r3.*z4-r4.*z3-r1.*x_loc.*z2+r2.*x_loc.*z1+r1.*x_loc.*z3-r3.*x_loc.*z1-r2.*x_loc.*z4+r4.*x_loc.*z2+r3.*x_loc.*z4-r4.*x_loc.*z3-r1.*y_loc.*z3+r3.*y_loc.*z1+r1.*y_loc.*z4+r2.*y_loc.*z3-r3.*y_loc.*z2-r4.*y_loc.*z1-r2.*y_loc.*z4+r4.*y_loc.*z2),(r1.*(-1.0./2.0)+r2.*(1.0./2.0)+r3.*(1.0./2.0)-r4.*(1.0./2.0)-z1.*(1.0./2.0)+z2.*(1.0./2.0)+z3.*(1.0./2.0)-z4.*(1.0./2.0)+r1.*x_loc-r2.*x_loc+x_loc.*z1.*(1.0./2.0)-x_loc.*z2.*(1.0./2.0)+x_loc.*z3.*(1.0./2.0)-x_loc.*z4.*(1.0./2.0)-y_loc.*z1.*(1.0./2.0)+y_loc.*z2.*(1.0./2.0)+y_loc.*z3.*(1.0./2.0)-y_loc.*z4.*(1.0./2.0)-r1.*x_loc.^2.*(1.0./2.0)+r2.*x_loc.^2.*(1.0./2.0)-r3.*x_loc.^2.*(1.0./2.0)+r4.*x_loc.^2.*(1.0./2.0)+x_loc.*y_loc.*z1.*(1.0./2.0)-x_loc.*y_loc.*z2.*(1.0./2.0)+x_loc.*y_loc.*z3.*(1.0./2.0)-x_loc.*y_loc.*z4.*(1.0./2.0))./(r1.*z2-r2.*z1-r1.*z4+r2.*z3-r3.*z2+r4.*z1+r3.*z4-r4.*z3-r1.*x_loc.*z2+r2.*x_loc.*z1+r1.*x_loc.*z3-r3.*x_loc.*z1-r2.*x_loc.*z4+r4.*x_loc.*z2+r3.*x_loc.*z4-r4.*x_loc.*z3-r1.*y_loc.*z3+r3.*y_loc.*z1+r1.*y_loc.*z4+r2.*y_loc.*z3-r3.*y_loc.*z2-r4.*y_loc.*z1-r2.*y_loc.*z4+r4.*y_loc.*z2),zeros(length(r1),1),-((x_loc-1.0).*(y_loc+1.0))./(r1.*(x_loc-1.0).*(y_loc-1.0)-r2.*(x_loc-1.0).*(y_loc+1.0)+r3.*(x_loc+1.0).*(y_loc+1.0)-r4.*(x_loc+1.0).*(y_loc-1.0)),(r1-r3-r1.*x_loc+r4.*x_loc-r3.*y_loc+r4.*y_loc)./(r1.*z2-r2.*z1-r1.*z4+r2.*z3-r3.*z2+r4.*z1+r3.*z4-r4.*z3-r1.*x_loc.*z2+r2.*x_loc.*z1+r1.*x_loc.*z3-r3.*x_loc.*z1-r2.*x_loc.*z4+r4.*x_loc.*z2+r3.*x_loc.*z4-r4.*x_loc.*z3-r1.*y_loc.*z3+r3.*y_loc.*z1+r1.*y_loc.*z4+r2.*y_loc.*z3-r3.*y_loc.*z2-r4.*y_loc.*z1-r2.*y_loc.*z4+r4.*y_loc.*z2),zeros(length(r1),1),(r1-r3-r1.*x_loc+r4.*x_loc-r3.*y_loc+r4.*y_loc)./(r1.*z2-r2.*z1-r1.*z4+r2.*z3-r3.*z2+r4.*z1+r3.*z4-r4.*z3-r1.*x_loc.*z2+r2.*x_loc.*z1+r1.*x_loc.*z3-r3.*x_loc.*z1-r2.*x_loc.*z4+r4.*x_loc.*z2+r3.*x_loc.*z4-r4.*x_loc.*z3-r1.*y_loc.*z3+r3.*y_loc.*z1+r1.*y_loc.*z4+r2.*y_loc.*z3-r3.*y_loc.*z2-r4.*y_loc.*z1-r2.*y_loc.*z4+r4.*y_loc.*z2),zeros(length(r1),1),(r1.*(-1.0./2.0)+r2.*(1.0./2.0)+r3.*(1.0./2.0)-r4.*(1.0./2.0)-z1.*(1.0./2.0)+z2.*(1.0./2.0)+z3.*(1.0./2.0)-z4.*(1.0./2.0)+r1.*x_loc-r2.*x_loc+x_loc.*z1.*(1.0./2.0)-x_loc.*z2.*(1.0./2.0)+x_loc.*z3.*(1.0./2.0)-x_loc.*z4.*(1.0./2.0)-y_loc.*z1.*(1.0./2.0)+y_loc.*z2.*(1.0./2.0)+y_loc.*z3.*(1.0./2.0)-y_loc.*z4.*(1.0./2.0)-r1.*x_loc.^2.*(1.0./2.0)+r2.*x_loc.^2.*(1.0./2.0)-r3.*x_loc.^2.*(1.0./2.0)+r4.*x_loc.^2.*(1.0./2.0)+x_loc.*y_loc.*z1.*(1.0./2.0)-x_loc.*y_loc.*z2.*(1.0./2.0)+x_loc.*y_loc.*z3.*(1.0./2.0)-x_loc.*y_loc.*z4.*(1.0./2.0))./(r1.*z2-r2.*z1-r1.*z4+r2.*z3-r3.*z2+r4.*z1+r3.*z4-r4.*z3-r1.*x_loc.*z2+r2.*x_loc.*z1+r1.*x_loc.*z3-r3.*x_loc.*z1-r2.*x_loc.*z4+r4.*x_loc.*z2+r3.*x_loc.*z4-r4.*x_loc.*z3-r1.*y_loc.*z3+r3.*y_loc.*z1+r1.*y_loc.*z4+r2.*y_loc.*z3-r3.*y_loc.*z2-r4.*y_loc.*z1-r2.*y_loc.*z4+r4.*y_loc.*z2),(r1.*(-1.0./2.0)+r2.*(1.0./2.0)+r3.*(1.0./2.0)-r4.*(1.0./2.0)+z1.*(1.0./2.0)-z2.*(1.0./2.0)-z3.*(1.0./2.0)+z4.*(1.0./2.0)+r3.*x_loc-r4.*x_loc-x_loc.*z1.*(1.0./2.0)+x_loc.*z2.*(1.0./2.0)-x_loc.*z3.*(1.0./2.0)+x_loc.*z4.*(1.0./2.0)+y_loc.*z1.*(1.0./2.0)-y_loc.*z2.*(1.0./2.0)-y_loc.*z3.*(1.0./2.0)+y_loc.*z4.*(1.0./2.0)+r1.*x_loc.^2.*(1.0./2.0)-r2.*x_loc.^2.*(1.0./2.0)+r3.*x_loc.^2.*(1.0./2.0)-r4.*x_loc.^2.*(1.0./2.0)-x_loc.*y_loc.*z1.*(1.0./2.0)+x_loc.*y_loc.*z2.*(1.0./2.0)-x_loc.*y_loc.*z3.*(1.0./2.0)+x_loc.*y_loc.*z4.*(1.0./2.0))./(r1.*z2-r2.*z1-r1.*z4+r2.*z3-r3.*z2+r4.*z1+r3.*z4-r4.*z3-r1.*x_loc.*z2+r2.*x_loc.*z1+r1.*x_loc.*z3-r3.*x_loc.*z1-r2.*x_loc.*z4+r4.*x_loc.*z2+r3.*x_loc.*z4-r4.*x_loc.*z3-r1.*y_loc.*z3+r3.*y_loc.*z1+r1.*y_loc.*z4+r2.*y_loc.*z3-r3.*y_loc.*z2-r4.*y_loc.*z1-r2.*y_loc.*z4+r4.*y_loc.*z2),zeros(length(r1),1),((x_loc+1.0).*(y_loc+1.0))./(r1.*(x_loc-1.0).*(y_loc-1.0)-r2.*(x_loc-1.0).*(y_loc+1.0)+r3.*(x_loc+1.0).*(y_loc+1.0)-r4.*(x_loc+1.0).*(y_loc-1.0)),(r2-r4+r1.*x_loc-r4.*x_loc-r1.*y_loc+r2.*y_loc)./(r1.*z2-r2.*z1-r1.*z4+r2.*z3-r3.*z2+r4.*z1+r3.*z4-r4.*z3-r1.*x_loc.*z2+r2.*x_loc.*z1+r1.*x_loc.*z3-r3.*x_loc.*z1-r2.*x_loc.*z4+r4.*x_loc.*z2+r3.*x_loc.*z4-r4.*x_loc.*z3-r1.*y_loc.*z3+r3.*y_loc.*z1+r1.*y_loc.*z4+r2.*y_loc.*z3-r3.*y_loc.*z2-r4.*y_loc.*z1-r2.*y_loc.*z4+r4.*y_loc.*z2),zeros(length(r1),1),(r2-r4+r1.*x_loc-r4.*x_loc-r1.*y_loc+r2.*y_loc)./(r1.*z2-r2.*z1-r1.*z4+r2.*z3-r3.*z2+r4.*z1+r3.*z4-r4.*z3-r1.*x_loc.*z2+r2.*x_loc.*z1+r1.*x_loc.*z3-r3.*x_loc.*z1-r2.*x_loc.*z4+r4.*x_loc.*z2+r3.*x_loc.*z4-r4.*x_loc.*z3-r1.*y_loc.*z3+r3.*y_loc.*z1+r1.*y_loc.*z4+r2.*y_loc.*z3-r3.*y_loc.*z2-r4.*y_loc.*z1-r2.*y_loc.*z4+r4.*y_loc.*z2),zeros(length(r1),1),(r1.*(-1.0./2.0)+r2.*(1.0./2.0)+r3.*(1.0./2.0)-r4.*(1.0./2.0)+z1.*(1.0./2.0)-z2.*(1.0./2.0)-z3.*(1.0./2.0)+z4.*(1.0./2.0)+r3.*x_loc-r4.*x_loc-x_loc.*z1.*(1.0./2.0)+x_loc.*z2.*(1.0./2.0)-x_loc.*z3.*(1.0./2.0)+x_loc.*z4.*(1.0./2.0)+y_loc.*z1.*(1.0./2.0)-y_loc.*z2.*(1.0./2.0)-y_loc.*z3.*(1.0./2.0)+y_loc.*z4.*(1.0./2.0)+r1.*x_loc.^2.*(1.0./2.0)-r2.*x_loc.^2.*(1.0./2.0)+r3.*x_loc.^2.*(1.0./2.0)-r4.*x_loc.^2.*(1.0./2.0)-x_loc.*y_loc.*z1.*(1.0./2.0)+x_loc.*y_loc.*z2.*(1.0./2.0)-x_loc.*y_loc.*z3.*(1.0./2.0)+x_loc.*y_loc.*z4.*(1.0./2.0))./(r1.*z2-r2.*z1-r1.*z4+r2.*z3-r3.*z2+r4.*z1+r3.*z4-r4.*z3-r1.*x_loc.*z2+r2.*x_loc.*z1+r1.*x_loc.*z3-r3.*x_loc.*z1-r2.*x_loc.*z4+r4.*x_loc.*z2+r3.*x_loc.*z4-r4.*x_loc.*z3-r1.*y_loc.*z3+r3.*y_loc.*z1+r1.*y_loc.*z4+r2.*y_loc.*z3-r3.*y_loc.*z2-r4.*y_loc.*z1-r2.*y_loc.*z4+r4.*y_loc.*z2),(r1.*(1.0./2.0)-r2.*(1.0./2.0)-r3.*(1.0./2.0)+r4.*(1.0./2.0)+z1.*(1.0./2.0)-z2.*(1.0./2.0)-z3.*(1.0./2.0)+z4.*(1.0./2.0)-r3.*x_loc+r4.*x_loc-x_loc.*z1.*(1.0./2.0)+x_loc.*z2.*(1.0./2.0)-x_loc.*z3.*(1.0./2.0)+x_loc.*z4.*(1.0./2.0)-y_loc.*z1.*(1.0./2.0)+y_loc.*z2.*(1.0./2.0)+y_loc.*z3.*(1.0./2.0)-y_loc.*z4.*(1.0./2.0)-r1.*x_loc.^2.*(1.0./2.0)+r2.*x_loc.^2.*(1.0./2.0)-r3.*x_loc.^2.*(1.0./2.0)+r4.*x_loc.^2.*(1.0./2.0)+x_loc.*y_loc.*z1.*(1.0./2.0)-x_loc.*y_loc.*z2.*(1.0./2.0)+x_loc.*y_loc.*z3.*(1.0./2.0)-x_loc.*y_loc.*z4.*(1.0./2.0))./(r1.*z2-r2.*z1-r1.*z4+r2.*z3-r3.*z2+r4.*z1+r3.*z4-r4.*z3-r1.*x_loc.*z2+r2.*x_loc.*z1+r1.*x_loc.*z3-r3.*x_loc.*z1-r2.*x_loc.*z4+r4.*x_loc.*z2+r3.*x_loc.*z4-r4.*x_loc.*z3-r1.*y_loc.*z3+r3.*y_loc.*z1+r1.*y_loc.*z4+r2.*y_loc.*z3-r3.*y_loc.*z2-r4.*y_loc.*z1-r2.*y_loc.*z4+r4.*y_loc.*z2),zeros(length(r1),1),-((x_loc+1.0).*(y_loc-1.0))./(r1.*(x_loc-1.0).*(y_loc-1.0)-r2.*(x_loc-1.0).*(y_loc+1.0)+r3.*(x_loc+1.0).*(y_loc+1.0)-r4.*(x_loc+1.0).*(y_loc-1.0)),-(r1-r3+r2.*x_loc-r3.*x_loc-r1.*y_loc+r2.*y_loc)./(r1.*z2-r2.*z1-r1.*z4+r2.*z3-r3.*z2+r4.*z1+r3.*z4-r4.*z3-r1.*x_loc.*z2+r2.*x_loc.*z1+r1.*x_loc.*z3-r3.*x_loc.*z1-r2.*x_loc.*z4+r4.*x_loc.*z2+r3.*x_loc.*z4-r4.*x_loc.*z3-r1.*y_loc.*z3+r3.*y_loc.*z1+r1.*y_loc.*z4+r2.*y_loc.*z3-r3.*y_loc.*z2-r4.*y_loc.*z1-r2.*y_loc.*z4+r4.*y_loc.*z2),zeros(length(r1),1),-(r1-r3+r2.*x_loc-r3.*x_loc-r1.*y_loc+r2.*y_loc)./(r1.*z2-r2.*z1-r1.*z4+r2.*z3-r3.*z2+r4.*z1+r3.*z4-r4.*z3-r1.*x_loc.*z2+r2.*x_loc.*z1+r1.*x_loc.*z3-r3.*x_loc.*z1-r2.*x_loc.*z4+r4.*x_loc.*z2+r3.*x_loc.*z4-r4.*x_loc.*z3-r1.*y_loc.*z3+r3.*y_loc.*z1+r1.*y_loc.*z4+r2.*y_loc.*z3-r3.*y_loc.*z2-r4.*y_loc.*z1-r2.*y_loc.*z4+r4.*y_loc.*z2),zeros(length(r1),1),(r1.*(1.0./2.0)-r2.*(1.0./2.0)-r3.*(1.0./2.0)+r4.*(1.0./2.0)+z1.*(1.0./2.0)-z2.*(1.0./2.0)-z3.*(1.0./2.0)+z4.*(1.0./2.0)-r3.*x_loc+r4.*x_loc-x_loc.*z1.*(1.0./2.0)+x_loc.*z2.*(1.0./2.0)-x_loc.*z3.*(1.0./2.0)+x_loc.*z4.*(1.0./2.0)-y_loc.*z1.*(1.0./2.0)+y_loc.*z2.*(1.0./2.0)+y_loc.*z3.*(1.0./2.0)-y_loc.*z4.*(1.0./2.0)-r1.*x_loc.^2.*(1.0./2.0)+r2.*x_loc.^2.*(1.0./2.0)-r3.*x_loc.^2.*(1.0./2.0)+r4.*x_loc.^2.*(1.0./2.0)+x_loc.*y_loc.*z1.*(1.0./2.0)-x_loc.*y_loc.*z2.*(1.0./2.0)+x_loc.*y_loc.*z3.*(1.0./2.0)-x_loc.*y_loc.*z4.*(1.0./2.0))./(r1.*z2-r2.*z1-r1.*z4+r2.*z3-r3.*z2+r4.*z1+r3.*z4-r4.*z3-r1.*x_loc.*z2+r2.*x_loc.*z1+r1.*x_loc.*z3-r3.*x_loc.*z1-r2.*x_loc.*z4+r4.*x_loc.*z2+r3.*x_loc.*z4-r4.*x_loc.*z3-r1.*y_loc.*z3+r3.*y_loc.*z1+r1.*y_loc.*z4+r2.*y_loc.*z3-r3.*y_loc.*z2-r4.*y_loc.*z1-r2.*y_loc.*z4+r4.*y_loc.*z2)];